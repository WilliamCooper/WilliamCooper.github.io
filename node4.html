<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2018.3 (Released July 19, 2018) -->
<HTML lang="EN">
<HEAD>
<TITLE>4. More Details About Plotting</TITLE>
<META NAME="description" CONTENT="4. More Details About Plotting">
<META NAME="keywords" CONTENT="R4RAF">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018.3">

<LINK REL="STYLESHEET" HREF="R4RAF.css">

<LINK REL="next" HREF="node5.html">
<LINK REL="previous" HREF="node3.html">
<LINK REL="next" HREF="node5.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="R4RAF.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node5.html">5. Variance Spectra</A>
<B> Up:</B> <A
 HREF="R4RAF.html">Ranadu: An R Package</A>
<B> Previous:</B> <A
 HREF="node3.html">3. Overview of Ranadu</A>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A ID="tex2html71"
  HREF="node4.html#SECTION00410000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN> Pipes</A>
<LI><A ID="tex2html72"
  HREF="node4.html#SECTION00420000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN> Multi-Frame Plots</A>
<UL>
<LI><A ID="tex2html73"
  HREF="node4.html#SECTION00421000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Multiple plotWAC( ) plots:</A>
<LI><A ID="tex2html74"
  HREF="node4.html#SECTION00422000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN> Panels and Facets in ggplotWAC( ):</A>
</UL>
<BR>
<LI><A ID="tex2html75"
  HREF="node4.html#SECTION00430000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">3</SPAN> Plotting the density of events</A>
<LI><A ID="tex2html76"
  HREF="node4.html#SECTION00440000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">4</SPAN> Error bars and box-and-whisker plots</A>
<LI><A ID="tex2html77"
  HREF="node4.html#SECTION00450000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">5</SPAN> The skew-T thermodynamic diagram</A>
<LI><A ID="tex2html78"
  HREF="node4.html#SECTION00460000000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">6</SPAN> Aerosol- and hydrometeor-size distributions</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A ID="SECTION00400000000000000000">
<SPAN CLASS="arabic">4</SPAN>. More Details About Plotting</A>
</H1><FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">This chapter includes additional details about the plot functions
available in Ranadu.
</FONT></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<H1><A ID="SECTION00410000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN> Pipes</A>
</H1><FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">When constructing plots, the use of &ldquo;pipes&rdquo; makes the logic clear
and is recommended, so that is described first. All the code sequences
described here can be implemented by saving the result from each step
and then providing it to the next step, but pipes support the transmission
of the result of a calculation to the next stage in the calculation
without the need for intermediate storage. They are supported using
the &ldquo;%&gt;%&rdquo; argument, which is enabled by the &ldquo;magrittr&rdquo; package
for R. Perhaps the strongest argument for using pipes is that they
make the logic of plot construction clear. You start with a data.frame,
optionally construct new variables, make appropriate selection of
variables and the time interval, apply filters to accept only data
meeting particular tests, and then construct the plot using the resulting
tailored data.frame. Here is an example, where the data.frame is piped
to &ldquo;select()&rdquo; (part of the dplyr package that passes on only the
listed variables) and where the result is then piped to &ldquo;Ranadu::selectTime()&rdquo;
where only the specified time range is transmitted forward. The result
is finally piped to Ranadu::plotWAC(), where the first argument is
a data.frame. That is supplied by the pipe. The result is shown in
Fig.&nbsp;<A HREF="#fig:pipe-example">4.1</A>. Alternately, ggplotWAC() could be used
to produce a similar result. In addition to showing the explicit steps
in the processing chain, code like this ensures that the plot will
be constructed the same way if the code is re-used or moved.
</FONT></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">
</FONT></FONT><FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue2291"><SPAN &nbsp;CLASS="textbf">library</SPAN></SPAN><SPAN ID="hue2294">(magrittr)</SPAN>
<BR><SPAN ID="hue2296">Ranadu</SPAN><SPAN ID="hue2298">::</SPAN><SPAN ID="hue2300"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue2303">(fname, Variables)</SPAN> <SPAN ID="hue2305">%&gt;%</SPAN> &nbsp;&nbsp;&nbsp;<SPAN ID="hue2307"><SPAN &nbsp;CLASS="textit">## load the data.frame</SPAN></SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue2310">dplyr</SPAN><SPAN ID="hue2312">::</SPAN><SPAN ID="hue2314"><SPAN &nbsp;CLASS="textbf">filter</SPAN></SPAN><SPAN ID="hue2317">(TASX</SPAN> <SPAN ID="hue2319">&gt;</SPAN> <SPAN ID="hue2321">90</SPAN><SPAN ID="hue2323">)</SPAN> <SPAN ID="hue2325">%&gt;%</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2327"><SPAN &nbsp;CLASS="textit">## limit based on airspeed </SPAN></SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue2330">dplyr</SPAN><SPAN ID="hue2332">::</SPAN><SPAN ID="hue2334"><SPAN &nbsp;CLASS="textbf">select</SPAN></SPAN><SPAN ID="hue2337">(Time, ATX, DPXC)</SPAN> <SPAN ID="hue2339">%&gt;%</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2341"><SPAN &nbsp;CLASS="textit">## select the variables to plot</SPAN></SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue2344">Ranadu</SPAN><SPAN ID="hue2346">::</SPAN><SPAN ID="hue2348"><SPAN &nbsp;CLASS="textbf">Rmutate</SPAN></SPAN><SPAN ID="hue2351">(</SPAN><SPAN ID="hue2353">DPD</SPAN> <SPAN ID="hue2355">= ATX</SPAN> <SPAN ID="hue2357">-</SPAN> <SPAN ID="hue2359">DPXC)</SPAN> <SPAN ID="hue2361">%&gt;%</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2363"><SPAN &nbsp;CLASS="textit">## add the dewpoint-depression DPD</SPAN></SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue2366">Ranadu</SPAN><SPAN ID="hue2368">::</SPAN><SPAN ID="hue2370"><SPAN &nbsp;CLASS="textbf">selectTime</SPAN></SPAN><SPAN ID="hue2373">(</SPAN><SPAN ID="hue2375">220500</SPAN><SPAN ID="hue2377">,</SPAN> <SPAN ID="hue2379">221500</SPAN><SPAN ID="hue2381">)</SPAN> <SPAN ID="hue2383">%&gt;%</SPAN> &nbsp;&nbsp;<SPAN ID="hue2385"><SPAN &nbsp;CLASS="textit">## set the time range</SPAN></SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue2388">Ranadu</SPAN><SPAN ID="hue2390">::</SPAN><SPAN ID="hue2392"><SPAN &nbsp;CLASS="textbf">plotWAC</SPAN></SPAN><SPAN ID="hue2395">(</SPAN><SPAN ID="hue2397">col</SPAN><SPAN ID="hue2399">=</SPAN><SPAN ID="hue2401"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2404">(</SPAN><SPAN ID="hue2406">'blue'</SPAN><SPAN ID="hue2408">,</SPAN> <SPAN ID="hue2410">'forestgreen'</SPAN><SPAN ID="hue2412">,</SPAN> <SPAN ID="hue2414">'black'</SPAN><SPAN ID="hue2416">))</SPAN> &nbsp;<SPAN ID="hue2418"><SPAN &nbsp;CLASS="textit">## construct the plot</SPAN></SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:pipe-example"></A><A ID="569"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.1:</STRONG>
Example of a figure generated using pipes. The variables are air temperature (ATX), dew point temperature (DPXC), and a new generated variable representing the dew point depression (DPD=ATX-DPXC). From WECAN research flight 6, 3 August 2018.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./pipe-example-1.png"
 ALT="Image pipe-example-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>
<FONT COLOR="#585858">More information on some of the utility functions used or available
when constructing plots is provided in the following list:
</FONT>
<OL>
<LI><SPAN  CLASS="texttt">dplyr::filter(): </SPAN>This function is used to limit the range
of accepted values. The arguments are a data.frame (provided above
by the pipe) and a logical statement. Only rows for which the specified
test is true are included in the resulting data.frame. An example
where a statement like this might be useful is when fitting to determine
the sensitivity coefficients for angle of attack, because it is useful
to exclude slow flight when the gear and/or flaps might be deployed.
Be sure to use the version from dplyr; the filter functions from the
packages &ldquo;stats&rdquo; or &ldquo;signal&rdquo; have different behavior. An alternative
method of creating a subset is to use the notation &ldquo;Data[Data$TASX
&gt; 90, ]&rdquo;. The disadvantage of this method and of the &ldquo;select(Data,
Data$TASX &gt; 90)&rdquo; function provided by base-R is that variable attributes
are lost.<A ID="tex2html7"
  HREF="footnode.html#foot577"><SUP><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN></SUP></A>
</LI>
<LI><SPAN  CLASS="texttt">dplyr::select(): </SPAN>This function creates a subset data.frame
with only the desired variables. The desired list of names can be
specified either as character names (with quotes) or variable names
(without quotes). This also has the advantage over the &ldquo;[]&rdquo;
or &ldquo;[[]]&rdquo; methods of subsetting that attributes of the
data.frame and the variables are preserved.
</LI>
<LI><SPAN  CLASS="texttt">Ranadu::Rmutate( ):</SPAN> This function adds new variables to the
data.frame according to formulas specified in the second argument.
In this processing chain, the first argument is the data.frame provided
by the pipe. This calls the routine <SPAN  CLASS="texttt">dplyr::mutate()</SPAN> but then,
because that function does not preserve variable attributes, it transfers
attributes from the input to the output data.frame. New variables,
however, have no attributes (even the &ldquo;Dimension&rdquo; attribute) so
the resulting data.frame has some limitations, notably not being accepted
by &ldquo;makeNetCDF( )&rdquo;.
</LI>
<LI><SPAN  CLASS="texttt">Ranadu::selectTime( ): </SPAN>This function limits the time range
of the resulting data.frame to be between the times that are specified
in HHMMSS format (hours, minutes, seconds). This is equivalent to
using &ldquo;dplyr::filter( )&rdquo; with limits on the accepted times, but
it avoids the need to provide those times in the POSIXct format used
by Ranadu data.frames. It preserves attributes and is suitable for
use in pipes.
</LI>
<LI><SPAN  CLASS="texttt">Ranadu::Rsubset( ): </SPAN>This is not used in the present example
but could be. It accepts start and end times like &ldquo;selectTime&rdquo;,
selects variables like &ldquo;dplyr::select&rdquo;, and imposes limitations
on the data like &ldquo;dplyr::filter( )&rdquo;, so several functions could
be combined in one step: Ranadu::getNetCDF(fname, Variables) %&gt;%
Ranadu::Rsubset(220500, 221500, c('ATX', 'DPXC')) %&gt;% plotWAC( ).
This function also preserves attributes in the modified data.frame.
</LI>
</OL><FONT COLOR="#585858">
&ldquo;Ranadu::plotWAC( )&rdquo; is designed primarily for time-series plots,
but scatterplots can also be generated. In that case, the first two
variables in the data.frame should be the variables for the scatterplot,
not the Time variable, and an explicit label &ldquo;xlab=xxx&rdquo; should
be supplied. Here is an example:
</FONT>
<P>
<FONT COLOR="#585858">
<FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue2421">Data</SPAN> <SPAN ID="hue2423">%&gt;%</SPAN> <SPAN ID="hue2425"><SPAN &nbsp;CLASS="textbf">selectTime</SPAN></SPAN><SPAN ID="hue2428">(</SPAN><SPAN ID="hue2430">220000</SPAN><SPAN ID="hue2432">,</SPAN> <SPAN ID="hue2434">221500</SPAN><SPAN ID="hue2436">)</SPAN> <SPAN ID="hue2438">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2440">dplyr</SPAN><SPAN ID="hue2442">::</SPAN><SPAN ID="hue2444"><SPAN &nbsp;CLASS="textbf">select</SPAN></SPAN><SPAN ID="hue2447">(ATX, DPXC)</SPAN> <SPAN ID="hue2449">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2451"><SPAN &nbsp;CLASS="textbf">plotWAC</SPAN></SPAN><SPAN ID="hue2454">(</SPAN><SPAN ID="hue2456">xlab</SPAN><SPAN ID="hue2458">=</SPAN><SPAN ID="hue2460">'ATX'</SPAN><SPAN ID="hue2462">,</SPAN> <SPAN ID="hue2464">type</SPAN><SPAN ID="hue2466">=</SPAN><SPAN ID="hue2468">'p'</SPAN><SPAN ID="hue2470">)</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:scat-ex"></A><A ID="625"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.2:</STRONG>
Example scatterplot.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./scat-ex-1.png"
 ALT="Image scat-ex-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>
</FONT></FONT>
<H1><A ID="SECTION00420000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN> Multi-Frame Plots</A>
</H1><FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">It is often desirable to combine several plots into a single plot.
There are several ways to do this with Ranadu routines:
</FONT></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<H2><A ID="SECTION00421000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">1</SPAN> Multiple plotWAC( ) plots:</A>
</H2><FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">The &ldquo;layout()&rdquo; function in base-R can be used. Here is an example.
The matrix layout can also be used to display plots in multiple columns
or in multiple rows and columns.
</FONT></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">
</FONT></FONT><FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue2472"><SPAN &nbsp;CLASS="textbf">layout</SPAN></SPAN><SPAN ID="hue2475">(</SPAN><SPAN ID="hue2477"><SPAN &nbsp;CLASS="textbf">matrix</SPAN></SPAN><SPAN ID="hue2480">(</SPAN><SPAN ID="hue2482">1</SPAN><SPAN ID="hue2484">:</SPAN><SPAN ID="hue2486">2</SPAN><SPAN ID="hue2488">,</SPAN> <SPAN ID="hue2490">ncol</SPAN><SPAN ID="hue2492">=</SPAN><SPAN ID="hue2494">1</SPAN><SPAN ID="hue2496">),</SPAN> <SPAN ID="hue2498">widths</SPAN><SPAN ID="hue2500">=</SPAN><SPAN ID="hue2502"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2505">(</SPAN><SPAN ID="hue2507">8</SPAN><SPAN ID="hue2509">,</SPAN><SPAN ID="hue2511">8</SPAN><SPAN ID="hue2513">),</SPAN> <SPAN ID="hue2515">heights</SPAN><SPAN ID="hue2517">=</SPAN><SPAN ID="hue2519"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2522">(</SPAN><SPAN ID="hue2524">5.5</SPAN><SPAN ID="hue2526">,</SPAN><SPAN ID="hue2528">8</SPAN><SPAN ID="hue2530">))</SPAN>
<BR><SPAN ID="hue2532">op</SPAN> <SPAN ID="hue2534">&lt;-</SPAN> <SPAN ID="hue2536"><SPAN &nbsp;CLASS="textbf">par</SPAN></SPAN> <SPAN ID="hue2539">(</SPAN><SPAN ID="hue2541">mar</SPAN><SPAN ID="hue2543">=</SPAN><SPAN ID="hue2545"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2548">(</SPAN><SPAN ID="hue2550">2</SPAN><SPAN ID="hue2552">,</SPAN><SPAN ID="hue2554">4</SPAN><SPAN ID="hue2556">,</SPAN><SPAN ID="hue2558">1</SPAN><SPAN ID="hue2560">,</SPAN><SPAN ID="hue2562">1</SPAN><SPAN ID="hue2564">)</SPAN><SPAN ID="hue2566">+</SPAN><SPAN ID="hue2568">0.1</SPAN><SPAN ID="hue2570">,</SPAN> <SPAN ID="hue2572">oma</SPAN><SPAN ID="hue2574">=</SPAN><SPAN ID="hue2576"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2579">(</SPAN><SPAN ID="hue2581">1.1</SPAN><SPAN ID="hue2583">,</SPAN><SPAN ID="hue2585">0</SPAN><SPAN ID="hue2587">,</SPAN><SPAN ID="hue2589">0</SPAN><SPAN ID="hue2591">,</SPAN><SPAN ID="hue2593">0</SPAN><SPAN ID="hue2595">))</SPAN>
<BR><SPAN ID="hue2597">Data</SPAN> <SPAN ID="hue2599">%&gt;%</SPAN> <SPAN ID="hue2601">dplyr</SPAN><SPAN ID="hue2603">::</SPAN><SPAN ID="hue2605"><SPAN &nbsp;CLASS="textbf">select</SPAN></SPAN><SPAN ID="hue2608">(Time, ATX)</SPAN> <SPAN ID="hue2610">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2612"><SPAN &nbsp;CLASS="textbf">plotWAC</SPAN></SPAN><SPAN ID="hue2615">(</SPAN><SPAN ID="hue2617">ylab</SPAN><SPAN ID="hue2619">=</SPAN><SPAN ID="hue2621"><SPAN &nbsp;CLASS="textbf">expression</SPAN></SPAN><SPAN ID="hue2624">(</SPAN><SPAN ID="hue2626"><SPAN &nbsp;CLASS="textbf">paste</SPAN></SPAN><SPAN ID="hue2629">(</SPAN><SPAN ID="hue2631">&#34;T [&#34;</SPAN><SPAN ID="hue2633">, degree,</SPAN> <SPAN ID="hue2635">&#34;C]&#34;</SPAN><SPAN ID="hue2637">)))</SPAN>
<BR><SPAN ID="hue2639">op</SPAN> <SPAN ID="hue2641">&lt;-</SPAN> <SPAN ID="hue2643"><SPAN &nbsp;CLASS="textbf">par</SPAN></SPAN> <SPAN ID="hue2646">(</SPAN><SPAN ID="hue2648">mar</SPAN><SPAN ID="hue2650">=</SPAN><SPAN ID="hue2652"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2655">(</SPAN><SPAN ID="hue2657">5</SPAN><SPAN ID="hue2659">,</SPAN><SPAN ID="hue2661">4</SPAN><SPAN ID="hue2663">,</SPAN><SPAN ID="hue2665">1</SPAN><SPAN ID="hue2667">,</SPAN><SPAN ID="hue2669">1</SPAN><SPAN ID="hue2671">)</SPAN><SPAN ID="hue2673">+</SPAN><SPAN ID="hue2675">0.1</SPAN><SPAN ID="hue2677">)</SPAN>
<BR><SPAN ID="hue2679">Data</SPAN> <SPAN ID="hue2681">%&gt;%</SPAN> <SPAN ID="hue2683">dplyr</SPAN><SPAN ID="hue2685">::</SPAN><SPAN ID="hue2687"><SPAN &nbsp;CLASS="textbf">select</SPAN></SPAN><SPAN ID="hue2690">(Time, WIC)</SPAN> <SPAN ID="hue2692">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2694"><SPAN &nbsp;CLASS="textbf">plotWAC</SPAN></SPAN><SPAN ID="hue2697">(</SPAN><SPAN ID="hue2699">ylab</SPAN><SPAN ID="hue2701">=</SPAN><SPAN ID="hue2703"><SPAN &nbsp;CLASS="textbf">expression</SPAN></SPAN><SPAN ID="hue2706">(</SPAN><SPAN ID="hue2708"><SPAN &nbsp;CLASS="textbf">paste</SPAN></SPAN><SPAN ID="hue2711">(</SPAN><SPAN ID="hue2713">'W [m/s]'</SPAN><SPAN ID="hue2715">)))</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:layout-example"></A><A ID="756"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.3:</STRONG>
Two-panel figure.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./layout-example-1.png"
 ALT="Image layout-example-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>
</FONT>
<H2><A ID="SECTION00422000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN>.<SPAN CLASS="arabic">2</SPAN> Panels and Facets in ggplotWAC( ):</A>
</H2><FONT COLOR="#585858"></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">The function <SPAN  CLASS="texttt">Ranadu::ggplotWAC( )</SPAN> is based on the ggplot2
package for R, which provides extensive plotting capabilities and
is highly recommended. What is provided via ggplotWAC( ) is a very
simplified and restricted approach, but it might be useful in preliminary
applications. See <a href="http://had.co.nz/ggplot2/">this URL</a> for
information on ggplot2. The Ranadu routine provides two approaches
to multiple plots:
</FONT></FONT>
<UL>
<LI>&ldquo;facets&rdquo;: If the argument &ldquo;panels&rdquo; is supplied
(e.g., panels=N), ggplotWAC( ) will construct N vertically aligned
panels. All will contain time-series plots. The first-argument to
ggplotWAC(), the data.frame, should contain the variable &ldquo;Time&rdquo;
and N*M variables, where the first M variables will be plotted in
the first panel, the next M in the second panel, etc. A set of M character-mode
labels should be supplied via labelN.
</LI>
<LI>&ldquo;viewports&rdquo;: An optional argument &ldquo;position=c(i,
j)&rdquo; can be used to place a plot in the ith of j vertically aligned
viewports.
</LI>
</UL><FONT COLOR="#585858"><FONT COLOR="#585858">
Examples are shown in Figs.&nbsp;<A HREF="#fig:gg-facets">4.4</A> and <A HREF="#fig:gg-viewports">4.5</A>.
An advantage of the faceted plot is that vertical alignment of the
plots is ensured; this can be a problem with other plots if the axis
labels are of different size in the different plots. In the second
case, the viewports are positioned so that the abscissa labels and
title are obscured for the top plot. The intent is that this should
be used for identical time scales for each plot, so that it is not
necessary to duplicate the axis labels and title.
</FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">
</FONT><FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue2717">Project</SPAN> <SPAN ID="hue2719">&lt;-</SPAN> <SPAN ID="hue2721">'WECAN'</SPAN> &nbsp;&nbsp;&nbsp;<SPAN ID="hue2723"><SPAN &nbsp;CLASS="textit">## faceted plot with ggplotWAC()</SPAN></SPAN>
<BR><SPAN ID="hue2726">Flight</SPAN> <SPAN ID="hue2728">&lt;-</SPAN> <SPAN ID="hue2730">5</SPAN>
<BR><SPAN ID="hue2732">V</SPAN> <SPAN ID="hue2734">&lt;-</SPAN> <SPAN ID="hue2736"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2739">(</SPAN><SPAN ID="hue2741">'ATH1'</SPAN><SPAN ID="hue2743">,</SPAN> <SPAN ID="hue2745">'ATH2'</SPAN><SPAN ID="hue2747">,</SPAN> <SPAN ID="hue2749">'ATF1'</SPAN><SPAN ID="hue2751">,</SPAN> <SPAN ID="hue2753">'RTH1'</SPAN><SPAN ID="hue2755">,</SPAN> <SPAN ID="hue2757">'RTH2'</SPAN><SPAN ID="hue2759">,</SPAN> <SPAN ID="hue2761">'RTF1'</SPAN><SPAN ID="hue2763">)</SPAN>
<BR><SPAN ID="hue2765">fname</SPAN> <SPAN ID="hue2767">&lt;-</SPAN> <SPAN ID="hue2769"><SPAN &nbsp;CLASS="textbf">sprintf</SPAN></SPAN><SPAN ID="hue2772">(</SPAN><SPAN ID="hue2774">'%s%s/%srf%02d.nc'</SPAN><SPAN ID="hue2776">,</SPAN> <SPAN ID="hue2778"><SPAN &nbsp;CLASS="textbf">DataDirectory</SPAN></SPAN><SPAN ID="hue2781">(), Project, Project,</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2783">Flight)</SPAN>
<BR><SPAN ID="hue2785"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue2788">(fname, V,</SPAN> <SPAN ID="hue2790">200000</SPAN><SPAN ID="hue2792">,</SPAN> <SPAN ID="hue2794">201500</SPAN><SPAN ID="hue2796">)</SPAN> <SPAN ID="hue2798">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2800"><SPAN &nbsp;CLASS="textbf">ggplotWAC</SPAN></SPAN><SPAN ID="hue2803">(</SPAN><SPAN ID="hue2805">panels</SPAN><SPAN ID="hue2807">=</SPAN><SPAN ID="hue2809">2</SPAN><SPAN ID="hue2811">,</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2813">col</SPAN><SPAN ID="hue2815">=</SPAN><SPAN ID="hue2817"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2820">(</SPAN><SPAN ID="hue2822">'blue'</SPAN><SPAN ID="hue2824">,</SPAN> <SPAN ID="hue2826">'darkorange'</SPAN><SPAN ID="hue2828">,</SPAN> <SPAN ID="hue2830">'forestgreen'</SPAN><SPAN ID="hue2832">),</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2834">ylab</SPAN><SPAN ID="hue2836">=</SPAN><SPAN ID="hue2838"><SPAN &nbsp;CLASS="textbf">expression</SPAN></SPAN><SPAN ID="hue2841">(</SPAN><SPAN ID="hue2843"><SPAN &nbsp;CLASS="textbf">paste</SPAN></SPAN><SPAN ID="hue2846">(</SPAN><SPAN ID="hue2848">'temperature ['</SPAN><SPAN ID="hue2850">, degree,</SPAN><SPAN ID="hue2852">'C]'</SPAN><SPAN ID="hue2854">)),</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2856">lwd</SPAN><SPAN ID="hue2858">=</SPAN><SPAN ID="hue2860"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2863">(</SPAN><SPAN ID="hue2865">1.5</SPAN><SPAN ID="hue2867">,</SPAN> <SPAN ID="hue2869">0.8</SPAN><SPAN ID="hue2871">,</SPAN> <SPAN ID="hue2873">1</SPAN><SPAN ID="hue2875">),</SPAN> <SPAN ID="hue2877">lty</SPAN><SPAN ID="hue2879">=</SPAN><SPAN ID="hue2881"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2884">(</SPAN><SPAN ID="hue2886">1</SPAN><SPAN ID="hue2888">,</SPAN><SPAN ID="hue2890">2</SPAN><SPAN ID="hue2892">,</SPAN><SPAN ID="hue2894">1</SPAN><SPAN ID="hue2896">),</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2898">labelP</SPAN><SPAN ID="hue2900">=</SPAN><SPAN ID="hue2902"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2905">(</SPAN><SPAN ID="hue2907">' &nbsp;&nbsp;air temperature'</SPAN><SPAN ID="hue2909">,</SPAN> <SPAN ID="hue2911">' recovery temperature'</SPAN><SPAN ID="hue2913">),</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2915">labelL</SPAN><SPAN ID="hue2917">=</SPAN><SPAN ID="hue2919"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2922">(</SPAN><SPAN ID="hue2924">'H1'</SPAN><SPAN ID="hue2926">,</SPAN> <SPAN ID="hue2928">'H2'</SPAN><SPAN ID="hue2930">,</SPAN> <SPAN ID="hue2932">'F1'</SPAN><SPAN ID="hue2934">),</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue2936">legend.position</SPAN><SPAN ID="hue2938">=</SPAN><SPAN ID="hue2940"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2943">(</SPAN><SPAN ID="hue2945">0.5</SPAN><SPAN ID="hue2947">,</SPAN><SPAN ID="hue2949">0.95</SPAN><SPAN ID="hue2951">)</SPAN>
<BR><SPAN ID="hue2953">)</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:gg-facets"></A><A ID="894"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.4:</STRONG>
Example of a faceted ggplotWAC plot. Three temperature measurements are shown from probes identified as H1, H2, and F2. The top panel shows the air temperature, and the bottom panel the directly measured recovery temperature before correction for dynamic heating.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./gg-facets-1.png"
 ALT="Image gg-facets-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>

<P>
<FONT COLOR="#585858">
<FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue2955"><SPAN &nbsp;CLASS="textit">## viewport-plot with ggplotWAC()</SPAN></SPAN>
<BR><SPAN ID="hue2958">DG</SPAN> <SPAN ID="hue2960">&lt;-</SPAN> <SPAN ID="hue2962"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue2965">(fname, V,</SPAN> <SPAN ID="hue2967">200000</SPAN><SPAN ID="hue2969">,</SPAN> <SPAN ID="hue2971">201500</SPAN><SPAN ID="hue2973">)</SPAN>
<BR><SPAN ID="hue2975"><SPAN &nbsp;CLASS="textbf">with</SPAN></SPAN><SPAN ID="hue2978">(DG,</SPAN> <SPAN ID="hue2980"><SPAN &nbsp;CLASS="textbf">ggplotWAC</SPAN></SPAN><SPAN ID="hue2983">(</SPAN><SPAN ID="hue2985"><SPAN &nbsp;CLASS="textbf">data.frame</SPAN></SPAN><SPAN ID="hue2988">(Time, ATH1),</SPAN> <SPAN ID="hue2990">position</SPAN><SPAN ID="hue2992">=</SPAN><SPAN ID="hue2994"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue2997">(</SPAN><SPAN ID="hue2999">1</SPAN><SPAN ID="hue3001">,</SPAN><SPAN ID="hue3003">2</SPAN><SPAN ID="hue3005">)))</SPAN>
<BR><SPAN ID="hue3007"><SPAN &nbsp;CLASS="textbf">with</SPAN></SPAN><SPAN ID="hue3010">(DG,</SPAN> <SPAN ID="hue3012"><SPAN &nbsp;CLASS="textbf">ggplotWAC</SPAN></SPAN><SPAN ID="hue3015">(</SPAN><SPAN ID="hue3017"><SPAN &nbsp;CLASS="textbf">data.frame</SPAN></SPAN><SPAN ID="hue3020">(Time, ATF1),</SPAN> <SPAN ID="hue3022">position</SPAN><SPAN ID="hue3024">=</SPAN><SPAN ID="hue3026"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue3029">(</SPAN><SPAN ID="hue3031">2</SPAN><SPAN ID="hue3033">,</SPAN><SPAN ID="hue3035">2</SPAN><SPAN ID="hue3037">)))</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:gg-viewports"></A><A ID="947"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.5:</STRONG>
An example of selecting the figure position using viewports and the "position" argument to ggplotWAC().</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./gg-viewports-1.png"
 ALT="Image gg-viewports-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>

<P>
</FONT></FONT>
<H1><A ID="SECTION00430000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">3</SPAN> Plotting the density of events</A>
</H1><FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">A scatterplot like that in Fig.&nbsp;<A HREF="#fig:scat-ex">4.2</A> often is used
to show a two-dimensional display of where events occur. Such plots
are useful when the number of events is small, but for large numbers
of events the overlap of points can obscure relationships. The base-R
function &ldquo;smoothScatter()&rdquo; is one option for plotting the density
of points in such cases. Another is the &ldquo;filled.contour()&rdquo; function.
Ranadu provides a third option in the function Ranadu::contourPlot().
The number of bins, colors, and linear vs.&nbsp;logarithmic density intervals
can be provided as arguments to this function, although the defaults
often work acceptably. The following figure and code illustrates the
use of this plot. Additional more elegant solutions are provided by
the ggplot2 package.
</FONT></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">
</FONT></FONT><FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue3039"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue3042">(fname)</SPAN> <SPAN ID="hue3044">%&gt;%</SPAN> <SPAN ID="hue3046">dplyr</SPAN><SPAN ID="hue3048">::</SPAN><SPAN ID="hue3050"><SPAN &nbsp;CLASS="textbf">select</SPAN></SPAN><SPAN ID="hue3053">(ATX, DPXC)</SPAN> <SPAN ID="hue3055">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue3057"><SPAN &nbsp;CLASS="textbf">contourPlot</SPAN></SPAN><SPAN ID="hue3060">(</SPAN><SPAN ID="hue3062">title</SPAN><SPAN ID="hue3064">=</SPAN><SPAN ID="hue3066">'WECAN flight #5'</SPAN><SPAN ID="hue3068">)</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:contourPlot"></A><A ID="979"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.6:</STRONG>
Example of a density plot generated using Ranadu::contourPlot().</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./contourPlot-1.png"
 ALT="Image contourPlot-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>

<P>
</FONT>
<H1><A ID="SECTION00440000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">4</SPAN> Error bars and box-and-whisker plots</A>
</H1><FONT COLOR="#585858"></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">Ranadu provides the &ldquo;binStats()&rdquo; function to compile variable
characteristics needed to generate plots like error-bar plots and
box-and-whisker plots. The input should be a data.frame whose first
two columns specify the expected respective ordinate and abscissa
variables. Each row in the data.frame is assigned to a bin on the
basis of the value of the second variable, and for each bin the mean,
standard deviation, and number of events are accumulated for values
of the first variable in the data.frame. The output from binStats()
is a new four-column data.frame where the respective columns are the
mean value of the abscissa for each bin, the mean value of the ordinate
for all events in the bin, and corresponding standard deviation, and
the number of events in the bin.
</FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">
</FONT><FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue3070"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue3073">(fname)</SPAN> <SPAN ID="hue3075">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3077"><SPAN &nbsp;CLASS="textbf">Rmutate</SPAN></SPAN><SPAN ID="hue3080">(</SPAN><SPAN ID="hue3082">DPD</SPAN><SPAN ID="hue3084">=ATX</SPAN><SPAN ID="hue3086">-</SPAN><SPAN ID="hue3088">DPXC)</SPAN> <SPAN ID="hue3090">%&gt;%</SPAN> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue3092"><SPAN &nbsp;CLASS="textit">## define dew-point-depression variable</SPAN></SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3095">dplyr</SPAN><SPAN ID="hue3097">::</SPAN><SPAN ID="hue3099"><SPAN &nbsp;CLASS="textbf">select</SPAN></SPAN><SPAN ID="hue3102">(DPD, GGALT)</SPAN> <SPAN ID="hue3104">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3106"><SPAN &nbsp;CLASS="textbf">binStats</SPAN></SPAN><SPAN ID="hue3109">()</SPAN> <SPAN ID="hue3111">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3113"><SPAN &nbsp;CLASS="textbf">ggplot</SPAN></SPAN><SPAN ID="hue3116">(</SPAN><SPAN ID="hue3118"><SPAN &nbsp;CLASS="textbf">aes</SPAN></SPAN><SPAN ID="hue3121">(</SPAN><SPAN ID="hue3123">x</SPAN><SPAN ID="hue3125">=xc))</SPAN> <SPAN ID="hue3127">+</SPAN> <SPAN ID="hue3129"><SPAN &nbsp;CLASS="textbf">geom_point</SPAN></SPAN><SPAN ID="hue3132">(</SPAN><SPAN ID="hue3134"><SPAN &nbsp;CLASS="textbf">aes</SPAN></SPAN><SPAN ID="hue3137">(</SPAN><SPAN ID="hue3139">y</SPAN><SPAN ID="hue3141">=ybar),</SPAN> <SPAN ID="hue3143">color</SPAN><SPAN ID="hue3145">=</SPAN><SPAN ID="hue3147">'blue'</SPAN><SPAN ID="hue3149">)</SPAN> <SPAN ID="hue3151">+</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3153"><SPAN &nbsp;CLASS="textbf">geom_errorbar</SPAN></SPAN><SPAN ID="hue3156">(</SPAN><SPAN ID="hue3158"><SPAN &nbsp;CLASS="textbf">aes</SPAN></SPAN><SPAN ID="hue3161">(</SPAN><SPAN ID="hue3163">ymin</SPAN><SPAN ID="hue3165">=ybar</SPAN><SPAN ID="hue3167">-</SPAN><SPAN ID="hue3169">sigma,</SPAN> <SPAN ID="hue3171">ymax</SPAN><SPAN ID="hue3173">=ybar</SPAN><SPAN ID="hue3175">+</SPAN><SPAN ID="hue3177">sigma))</SPAN> <SPAN ID="hue3179">+</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3181"><SPAN &nbsp;CLASS="textbf">xlab</SPAN></SPAN><SPAN ID="hue3184">(</SPAN><SPAN ID="hue3186">'geometric altitude [m]'</SPAN><SPAN ID="hue3188">)</SPAN> <SPAN ID="hue3190">+</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3192"><SPAN &nbsp;CLASS="textbf">ylab</SPAN></SPAN><SPAN ID="hue3195">(</SPAN><SPAN ID="hue3197"><SPAN &nbsp;CLASS="textbf">expression</SPAN></SPAN><SPAN ID="hue3200">(</SPAN><SPAN ID="hue3202"><SPAN &nbsp;CLASS="textbf">paste</SPAN></SPAN><SPAN ID="hue3205">(</SPAN><SPAN ID="hue3207">'dew point depression ['</SPAN><SPAN ID="hue3209">, degree,</SPAN> <SPAN ID="hue3211">'C]'</SPAN><SPAN ID="hue3213">)))</SPAN> <SPAN ID="hue3215">+</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3217"><SPAN &nbsp;CLASS="textbf">theme_WAC</SPAN></SPAN><SPAN ID="hue3220">()</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:errorbar-plot"></A><A ID="1064"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.7:</STRONG>
Example of an error-bar plot generated using binStats().</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./errorbar-plot-1.png"
 ALT="Image errorbar-plot-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>
<FONT COLOR="#585858">The following code creates Fig.&nbsp;<A HREF="#fig:bwplot">4.8</A>, an
example of creating a box-and-whisker plot. When used with the argument
&ldquo;addBin = TRUE&rdquo;, binStats instead returns a modified data.frame
with a variable &ldquo;BIN&rdquo; added that is suitable to use when grouping
in ggplot aesthetics.
</FONT>
<P>
<FONT COLOR="#585858">
<FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue3222"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue3225">(fname)</SPAN> <SPAN ID="hue3227">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3229">dplyr</SPAN><SPAN ID="hue3231">::</SPAN><SPAN ID="hue3233"><SPAN &nbsp;CLASS="textbf">select</SPAN></SPAN><SPAN ID="hue3236">(DPXC, GGALT)</SPAN> <SPAN ID="hue3238">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3240"><SPAN &nbsp;CLASS="textbf">binStats</SPAN></SPAN><SPAN ID="hue3243">(</SPAN><SPAN ID="hue3245">addBin</SPAN> <SPAN ID="hue3247">=</SPAN> <SPAN ID="hue3249">TRUE</SPAN><SPAN ID="hue3251">)</SPAN> <SPAN ID="hue3253">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3255"><SPAN &nbsp;CLASS="textbf">ggplot</SPAN></SPAN><SPAN ID="hue3258">()</SPAN> <SPAN ID="hue3260">+</SPAN> <SPAN ID="hue3262"><SPAN &nbsp;CLASS="textbf">geom_boxplot</SPAN></SPAN><SPAN ID="hue3265">(</SPAN><SPAN ID="hue3267"><SPAN &nbsp;CLASS="textbf">aes</SPAN></SPAN><SPAN ID="hue3270">(GGALT, DPXC,</SPAN> <SPAN ID="hue3272">group</SPAN><SPAN ID="hue3274">=BIN),</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue3276">color</SPAN><SPAN ID="hue3278">=</SPAN><SPAN ID="hue3280">'blue'</SPAN><SPAN ID="hue3282">,</SPAN> <SPAN ID="hue3284">na.rm</SPAN><SPAN ID="hue3286">=</SPAN><SPAN ID="hue3288">TRUE</SPAN><SPAN ID="hue3290">)</SPAN> <SPAN ID="hue3292">+</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3294"><SPAN &nbsp;CLASS="textbf">theme_WAC</SPAN></SPAN><SPAN ID="hue3297">()</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:bwplot"></A><A ID="1115"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.8:</STRONG>
An example of a box-and-whisker plot.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./bwplot-1.png"
 ALT="Image bwplot-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>

<P>
</FONT></FONT>
<H1><A ID="SECTION00450000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">5</SPAN> The skew-T thermodynamic diagram</A>
</H1><FONT COLOR="#585858"><FONT COLOR="#585858"></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">Ranadu incorporates the ability to plot a set of measurements on the
background of a skew-T diagram. The background is non-standard and
is described in detail in <a href="https://WilliamCooper.github.io/www/SkewT.pdf">this document</a>.
The &ldquo;<SPAN  CLASS="texttt">Ranadu::SkewTSounding()</SPAN>&rdquo; function should be called
with a data.frame containing measurements of pressure, temperature
and dewpoint, which may be named either (&ldquo;PSXC&rdquo;, &ldquo;ATX&rdquo;, &ldquo;DPXC&rdquo;)
or (&ldquo;Pressure&rdquo;, &ldquo;Temperature&rdquo;, &ldquo;DewPoint&rdquo;). A skew-T background
is generated using the Ranadu data file &ldquo;skewTDiagram.Rdata&rdquo; and
the values from the input data.frame are optionally averaged in pressure
intervals and then plotted on this background. Figure&nbsp;<A HREF="#fig:skewT">4.9</A>
is an example of this plot.
</FONT></FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858"><FONT COLOR="#585858">
</FONT></FONT><FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue3299">Project</SPAN> <SPAN ID="hue3301">&lt;-</SPAN> <SPAN ID="hue3303">'PREDICT'</SPAN>
<BR><SPAN ID="hue3305">Flight</SPAN> <SPAN ID="hue3307">&lt;-</SPAN> <SPAN ID="hue3309">11</SPAN>
<BR><SPAN ID="hue3311">fname</SPAN> <SPAN ID="hue3313">&lt;-</SPAN> <SPAN ID="hue3315"><SPAN &nbsp;CLASS="textbf">sprintf</SPAN></SPAN> <SPAN ID="hue3318">(</SPAN><SPAN ID="hue3320">'%s%s/%srf%02d.nc'</SPAN><SPAN ID="hue3322">,</SPAN> <SPAN ID="hue3324"><SPAN &nbsp;CLASS="textbf">DataDirectory</SPAN></SPAN><SPAN ID="hue3327">(), Project,</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue3329">Project, Flight)</SPAN>
<BR><SPAN ID="hue3331"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue3334">(fname)</SPAN> <SPAN ID="hue3336">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue3338"><SPAN &nbsp;CLASS="textbf">selectTime</SPAN></SPAN><SPAN ID="hue3341">(</SPAN><SPAN ID="hue3343">0</SPAN><SPAN ID="hue3345">,</SPAN> <SPAN ID="hue3347">150000</SPAN><SPAN ID="hue3349">)</SPAN> <SPAN ID="hue3351">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;&nbsp;&nbsp;<SPAN ID="hue3353"><SPAN &nbsp;CLASS="textbf">SkewTSounding</SPAN></SPAN><SPAN ID="hue3356">(</SPAN><SPAN ID="hue3358">AverageInterval</SPAN><SPAN ID="hue3360">=</SPAN><SPAN ID="hue3362">10</SPAN><SPAN ID="hue3364">)</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:skewT"></A><A ID="1167"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.9:</STRONG>
Sounding from PREDICT flight 11.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./skewT-1.png"
 ALT="Image skewT-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>

<P>
</FONT>
<H1><A ID="SECTION00460000000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">6</SPAN> Aerosol- and hydrometeor-size distributions</A>
</H1><FONT COLOR="#585858"></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">The Ranadu function &ldquo;plotSD()&rdquo; displays the size distribution
measured by various probes that produce arrays of measurements. The
data.frame containing these measurements is special in that the column
corresponding to a variable name like &ldquo;CCDP_RPC&rdquo; is a two-dimensional
vector. This makes the data.frame inconsistent with the &ldquo;tidy&rdquo;
structure and with the structure required for a &ldquo;tibble&rdquo;, so some
special considerations are required if an analyst wants to use only
tidy data. In this section, those considerations are not discussed
further because the &ldquo;plotSD()&rdquo; function assumes Ranadu-style data.frame
conventions.
</FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">&ldquo;Ranadu::getNetCDF()&rdquo; accepts variable names like &ldquo;CCDP_&rdquo;,
in which case it searches for the first variable starting with that
name. This avoids the need to know the location of the CDP probe in
various projects. However, if there are multiple probes with the same
prefix name, they need to be specified in the variable list used to
construct the data.frame.
</FONT></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">An example, Fig.&nbsp;<A HREF="#fig:SD1">4.10</A>, shows code that will construct a
plot of the size distribution from several probes. The &ldquo;exceedance&rdquo;
is added when the argument &ldquo;CDF=TRUE&rdquo; is used; it is the complement
to a cumulative distribution and shows the fraction of particles that
exceed the plotted size. The four numbers returned from the function
are the mean concentration, mean diameter, standard deviation in the
diameter, and liquid water content under the assumption that all particles
are liquid. It is also possible to construct a plot of the distribution
in liquid water content, as shown in Fig.&nbsp;<A HREF="#fig:SD2">4.11</A>. See &ldquo;?Ranadu::plotSD&rdquo;
for more options including alternate specification of the size limits,
bins to include, and log vs linear axes.
</FONT></FONT>
<P>
<FONT COLOR="#585858"></FONT>
<P>
<FONT COLOR="#585858"><FONT COLOR="#585858">
</FONT><FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue3366"><SPAN &nbsp;CLASS="textit"># assignment to A just suppresses printing of the list returned from plotSD</SPAN></SPAN>
<BR><SPAN ID="hue3369">A</SPAN> <SPAN ID="hue3371">&lt;-</SPAN> <SPAN ID="hue3373"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue3376">(</SPAN><SPAN ID="hue3378">'/Data/CSET/CSETrf06.nc'</SPAN><SPAN ID="hue3380">,</SPAN> <SPAN ID="hue3382"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue3385">(</SPAN><SPAN ID="hue3387">'CCDP_'</SPAN><SPAN ID="hue3389">,</SPAN> <SPAN ID="hue3391">'C1DC_'</SPAN><SPAN ID="hue3393">,</SPAN> <SPAN ID="hue3395">'CUHSAS_'</SPAN><SPAN ID="hue3397">))</SPAN> <SPAN ID="hue3399">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3401"><SPAN &nbsp;CLASS="textbf">selectTime</SPAN></SPAN><SPAN ID="hue3404">(</SPAN><SPAN ID="hue3406">173000</SPAN><SPAN ID="hue3408">,</SPAN> <SPAN ID="hue3410">173500</SPAN><SPAN ID="hue3412">)</SPAN> <SPAN ID="hue3414">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3416"><SPAN &nbsp;CLASS="textbf">plotSD</SPAN></SPAN><SPAN ID="hue3419">(</SPAN><SPAN ID="hue3421">CellLimits</SPAN><SPAN ID="hue3423">=</SPAN><SPAN ID="hue3425">NA</SPAN><SPAN ID="hue3427">,</SPAN> <SPAN ID="hue3429">logAxis</SPAN><SPAN ID="hue3431">=</SPAN><SPAN ID="hue3433">'xy'</SPAN><SPAN ID="hue3435">,</SPAN> <SPAN ID="hue3437">CDF</SPAN><SPAN ID="hue3439">=</SPAN><SPAN ID="hue3441">TRUE</SPAN><SPAN ID="hue3443">)</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:SD1"></A><A ID="1224"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.10:</STRONG>
Example of a size distribution.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./SD1-1.png"
 ALT="Image SD1-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>

<P>
<FONT COLOR="#585858">
<FONT COLOR="#585858"><HR>## Generating R code:</FONT>
<P>

<DIV CLASS="alltt" ALIGN="LEFT">
<FONT COLOR="#585858"><SPAN style="font-family:monospace">
 <SPAN ID="hue3445">A</SPAN> <SPAN ID="hue3447">&lt;-</SPAN> <SPAN ID="hue3449"><SPAN &nbsp;CLASS="textbf">getNetCDF</SPAN></SPAN><SPAN ID="hue3452">(</SPAN><SPAN ID="hue3454">'/Data/CSET/CSETrf06.nc'</SPAN><SPAN ID="hue3456">,</SPAN> <SPAN ID="hue3458"><SPAN &nbsp;CLASS="textbf">c</SPAN></SPAN><SPAN ID="hue3461">(</SPAN><SPAN ID="hue3463">'CCDP_'</SPAN><SPAN ID="hue3465">,</SPAN> <SPAN ID="hue3467">'C1DC_'</SPAN><SPAN ID="hue3469">,</SPAN> <SPAN ID="hue3471">'CUHSAS_'</SPAN><SPAN ID="hue3473">))</SPAN> <SPAN ID="hue3475">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3477"><SPAN &nbsp;CLASS="textbf">selectTime</SPAN></SPAN><SPAN ID="hue3480">(</SPAN><SPAN ID="hue3482">173000</SPAN><SPAN ID="hue3484">,</SPAN> <SPAN ID="hue3486">173500</SPAN><SPAN ID="hue3488">)</SPAN> <SPAN ID="hue3490">%&gt;%</SPAN>
<BR>&nbsp;&nbsp;<SPAN ID="hue3492"><SPAN &nbsp;CLASS="textbf">plotSD</SPAN></SPAN><SPAN ID="hue3495">(</SPAN><SPAN ID="hue3497">CellLimits</SPAN><SPAN ID="hue3499">=</SPAN><SPAN ID="hue3501">NA</SPAN><SPAN ID="hue3503">,</SPAN> <SPAN ID="hue3505">logAxis</SPAN><SPAN ID="hue3507">=</SPAN><SPAN ID="hue3509">'xy'</SPAN><SPAN ID="hue3511">,</SPAN> <SPAN ID="hue3513">LWC</SPAN><SPAN ID="hue3515">=</SPAN><SPAN ID="hue3517">TRUE</SPAN><SPAN ID="hue3519">,</SPAN> <SPAN ID="hue3521">CDF</SPAN><SPAN ID="hue3523">=</SPAN><SPAN ID="hue3525">TRUE</SPAN><SPAN ID="hue3527">)</SPAN>
<BR></SPAN></FONT>
</DIV>
<FONT COLOR="#585858"><HR></FONT>
<DIV class="CENTER"><A ID="fig:SD2"></A><A ID="1280"></A>
<TABLE>
<CAPTION class="BOTTOM"><STRONG>Figure 4.11:</STRONG>
Example of a distribution in liquid water content.</CAPTION>
<TR><TD><P>
<DIV class="CENTER"><IMG STYLE=""
 SRC="./SD2-1.png"
 ALT="Image SD2-1"> 
</DIV>
<P>
<DIV class="CENTER"></DIV>

<P></TD></TR>
</TABLE>
</DIV>

<P>

<P>
</FONT></FONT>
<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="R4RAF.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A>   
<BR>
<B> Next:</B> <A
 HREF="node5.html">5. Variance Spectra</A>
<B> Up:</B> <A
 HREF="R4RAF.html">Ranadu: An R Package</A>
<B> Previous:</B> <A
 HREF="node3.html">3. Overview of Ranadu</A></DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
